cmake_minimum_required (VERSION 2.8.11)
project (testrepo)
set(CMAKE_CXX_STANDARD 11)
include(CTest)

set (testrepo_VERSION_MAJOR 0)
set (testrepo_VERSION_MINOR 1)

configure_file ("${PROJECT_SOURCE_DIR}/config/TestConfig.h.in" "${PROJECT_BINARY_DIR}/TestConfig.h")
include_directories("${PROJECT_BINARY_DIR}")

if (WIN32)
    configure_file ("${PROJECT_SOURCE_DIR}/config/windows/windows.h.in" "${PROJECT_BINARY_DIR}/os.h")
    add_executable(bin.exe test.cpp)
    add_test (TestRuns ${PROJECT_BINARY_DIR}/bin.exe)
endif (WIN32)

if (UNIX)
    if (APPLE)
        configure_file ("${PROJECT_SOURCE_DIR}/config/macos/macos.h.in" "${PROJECT_BINARY_DIR}/os.h")
        add_executable(bin.macho test.cpp)
        add_test (TestRuns ${PROJECT_BINARY_DIR}/bin.macho)
        break()
    endif(APPLE)
    configure_file ("${PROJECT_SOURCE_DIR}/config/linux/linux.h.in" "${PROJECT_BINARY_DIR}/os.h")
    add_executable(bin.elf test.cpp)
    add_test (TestRuns ${PROJECT_BINARY_DIR}/bin.elf)
endif (UNIX)